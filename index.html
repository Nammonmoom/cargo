<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Snake Game — GitHub Pages Ready</title>
  <style>
    :root{
      --bg:#0f1115; --panel:#161a22; --accent:#ffd21e; --text:#e7eaf3; --muted:#95a1b2;
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:radial-gradient(1000px 600px at 80% -10%, #1b2030 0%, var(--bg) 60%);
      color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      min-height:100dvh; display:grid; place-items:center; padding:24px;
    }
    .wrap{width:min(960px, 96vw);}
    header{display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:16px}
    h1{font-size:20px; margin:0; letter-spacing:.3px}
    .panel{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
           border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:14px 16px;}
    .hud{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .stat{background:var(--panel); border:1px solid rgba(255,255,255,.08); padding:8px 10px; border-radius:12px; min-width:90px; text-align:center}
    .stat b{color:var(--accent)}
    .controls{display:flex; gap:8px; flex-wrap:wrap}
    button{
      background:var(--panel); color:var(--text); border:1px solid rgba(255,255,255,.12);
      padding:10px 14px; border-radius:12px; font-weight:600; cursor:pointer; transition:transform .05s ease, border-color .2s ease, background .2s ease;
    }
    button:hover{border-color:var(--accent)}
    button:active{transform:translateY(1px)}
    canvas{display:block; width:min(480px, 92vw); height:auto; image-rendering:pixelated; background:#0c0f14; border-radius:16px; border:1px solid rgba(255,255,255,.08)}
    .grid-bg{position:relative;}
    .grid-bg::before{
      content:""; position:absolute; inset:0; pointer-events:none; border-radius:16px;
      background-image:linear-gradient(rgba(255,255,255,.05) 1px, transparent 1px),
                       linear-gradient(90deg, rgba(255,255,255,.05) 1px, transparent 1px);
      background-size:24px 24px, 24px 24px;
      mask:linear-gradient(#000, #000);
    }
    footer{margin-top:14px; color:var(--muted); font-size:13px}
    kbd{background:#22262f; border:1px solid #2c3240; border-bottom-color:#202632; border-radius:6px; padding:2px 6px; font-family:ui-monospace, SFMono-Regular, Menlo, monospace; font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="panel hud">
        <div class="stat">คะแนน: <b id="score">0</b></div>
        <div class="stat">สถิติสูงสุด: <b id="hi">0</b></div>
        <div class="stat">ความเร็ว: <b id="speed">1.0x</b></div>
      </div>
      <div class="panel controls">
        <button id="btnStart">เริ่ม / รีสตาร์ท</button>
        <button id="btnPause">พักเกม</button>
      </div>
    </header>

    <div class="grid-bg">
      <canvas id="game" width="480" height="480" aria-label="Snake game canvas"></canvas>
    </div>

    <footer class="panel">
      บังคับทิศทางด้วย <kbd>↑</kbd> <kbd>↓</kbd> <kbd>←</kbd> <kbd>→</kbd> หรือ <kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd> — ชนขอบหรือชนตัวเอง = Game Over
    </footer>
  </div>

  <script>
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const scoreEl = document.getElementById('score');
  const hiEl = document.getElementById('hi');
  const speedEl = document.getElementById('speed');
  const btnStart = document.getElementById('btnStart');
  const btnPause = document.getElementById('btnPause');

  const TILE = 24;
  const COLS = canvas.width / TILE;
  const ROWS = canvas.height / TILE;

  let snake, dir, nextDir, food, score, hiScore, alive, tickMs, acc, lastTs, paused;

  function init() {
    snake = [{x:10, y:10},{x:9,y:10},{x:8,y:10}];
    dir = {x:1, y:0};
    nextDir = {x:1, y:0};
    score = 0; alive = true; paused = false; acc = 0; lastTs = 0;
    tickMs = 140;
    hiScore = Number(localStorage.getItem('snake_hi')||0);
    placeFood();
    updateHUD();
    requestAnimationFrame(loop);
  }

  function updateHUD(){
    scoreEl.textContent = score;
    hiEl.textContent = hiScore;
    speedEl.textContent = (140 / tickMs).toFixed(1) + 'x';
  }

  function placeFood(){
    while(true){
      const fx = Math.floor(Math.random()*COLS);
      const fy = Math.floor(Math.random()*ROWS);
      if(!snake.some(s=>s.x===fx && s.y===fy)) { food = {x:fx,y:fy}; break; }
    }
  }

  function loop(ts){
    if(!alive) return;
    if(paused){ lastTs = ts; requestAnimationFrame(loop); return; }
    if(!lastTs) lastTs = ts;
    const dt = ts - lastTs; lastTs = ts; acc += dt;
    while(acc >= tickMs){
      step();
      acc -= tickMs;
    }
    draw();
    requestAnimationFrame(loop);
  }

  function step(){
    dir = nextDir;
    const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};
    if(head.x < 0 || head.x >= COLS || head.y < 0 || head.y >= ROWS){return gameOver();}
    if(snake.some((s,i)=> i>0 && s.x===head.x && s.y===head.y)){return gameOver();}
    snake.unshift(head);
    if(head.x === food.x && head.y === food.y){
      score += 10;
      tickMs = Math.max(64, tickMs - 4);
      if(score > hiScore){ hiScore = score; localStorage.setItem('snake_hi', hiScore); }
      placeFood();
      updateHUD();
    } else {
      snake.pop();
    }
  }

  function gameOver(){
    alive = false;
    draw();
    ctx.fillStyle = 'rgba(12,15,20,.82)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = '#ffd21e';
    ctx.font = 'bold 28px ui-sans-serif, system-ui';
    ctx.textAlign = 'center';
    ctx.fillText('Game Over', canvas.width/2, canvas.height/2 - 8);
    ctx.fillStyle = '#e7eaf3';
    ctx.font = '16px ui-sans-serif, system-ui';
    ctx.fillText(`คะแนน: ${score}  |  สถิติสูงสุด: ${hiScore}`, canvas.width/2, canvas.height/2 + 18);
  }

  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    drawCell(food.x, food.y, '#ffd21e');
    ctx.globalAlpha = .18; drawCell(food.x, food.y, '#fff'); ctx.globalAlpha = 1;
    for(let i=0;i<snake.length;i++){
      const c = i===0 ? '#6cf5a6' : '#3bd386';
      drawCell(snake[i].x, snake[i].y, c);
    }
  }

  function drawCell(x,y,color){
    const px = x*TILE, py = y*TILE, r = 6;
    ctx.fillStyle = color;
    roundRect(ctx, px+2, py+2, TILE-4, TILE-4, r);
    ctx.fill();
  }

  function roundRect(ctx, x, y, w, h, r){
    const rr = Math.min(r, w/2, h/2);
    ctx.beginPath();
    ctx.moveTo(x+rr, y);
    ctx.arcTo(x+w, y, x+w, y+h, rr);
    ctx.arcTo(x+w, y+h, x, y+h, rr);
    ctx.arcTo(x, y+h, x, y, rr);
    ctx.arcTo(x, y, x+w, y, rr);
    ctx.closePath();
  }

  const keyToDir = {
    ArrowUp:{x:0,y:-1},w:{x:0,y:-1},W:{x:0,y:-1},
    ArrowDown:{x:0,y:1},s:{x:0,y:1},S:{x:0,y:1},
    ArrowLeft:{x:-1,y:0},a:{x:-1,y:0},A:{x:-1,y:0},
    ArrowRight:{x:1,y:0},d:{x:1,y:0},D:{x:1,y:0}
  };
  window.addEventListener('keydown', e=>{
    const nd = keyToDir[e.key]; if(!nd) return;
    if(nd.x === -dir.x && nd.y === -dir.y) return;
    nextDir = nd;
  });

  btnStart.addEventListener('click', ()=>{ init(); });
  btnPause.addEventListener('click', ()=>{ if(!alive) return; paused = !paused; btnPause.textContent = paused? 'เล่นต่อ' : 'พักเกม'; });
  init();
  </script>
</body>
</html>